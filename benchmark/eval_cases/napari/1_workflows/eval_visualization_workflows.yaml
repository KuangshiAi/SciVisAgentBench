# Basic Visualization Workflow Tests
# Use https://www.ebi.ac.uk/bioimage-archive/galleries/S-BIAD573.html IM1 to test the workflows.

# Test: Multi-channel Overlay with Colormaps with channels
- vars:
    question: |
      1. Load the "data/dataset_001/dataset_002.tif" dataset into napari. 
      2. Depending on the number of channels, set the colormap for the first channel 0 to red and channel 1 to green.
      3. Switch to the 3D view. 
      4. Use additive blending for all channels to create an overlay visualization.
      5. Go the timestep 14. 
        Q1: Does the cell show protrusions? (Yes/No)
      6. Take a screenshot of the result, save it to "eval_visualization_workflows/screenshot_1.png"
      7. Answer Q1 in a plain text file "eval_visualization_workflows/Q1_answer.txt".
  assert:
    - type: llm-rubric
      subtype: vision
      value: |
          1. Does the visualization show a green cell with red blobs on the inside? 
          2. Does the result rendering look similar to ground truth?
      gs-file: GS/dataset_002_1.png
      rs-file: eval_visualization_workflows/screenshot_1.png
    - type: llm-rubric
      subtype: text
      value: |
          1. Q1 correct answer: Yes
      rs-file: eval_visualization_workflows/Q1_answer.txt                    
  options:
    cache: false
    runSerially: true

# Test: Hide All Channels Except for the Channel with the Cells
- vars:
    question: |
      1. Set all layers invisible except for the layer that contains the individual cells. 
      2. Take a screenshots of the result, save it to "eval_visualization_workflows/screenshot_2.png".
  assert:
    - type: llm-rubric
      subtype: vision
      value: |
          1. Are there only the green cells visible with no red blobs on the inside?
      rs-file: eval_visualization_workflows/screenshot_2.png
  options:
    cache: false
    runSerially: true

# Test: Advanced 3D Camera Control and Navigation
- vars:
    question: |
      1. Start in the 3D view
      2. Zoom into the cell with protrusions until the cell fills up the entire viewport. 
      3. Rotate the camera to show the 3D data from a different perspective (side view).
      4. Take a screenshot of the result, save it to "eval_visualization_workflows/screenshot_3.png".
  assert:
    - type: llm-rubric
      subtype: vision
      value: |
          1. Does the visualization show the green cell from the side? 
          2. Does the result rendering look similar to the ground truth image?
      gs-file: GS/dataset_002_2.jpg
      rs-file: eval_visualization_workflows/screenshot_3.png
             
  options:
    cache: false
    runSerially: true

# Test: Cleanup - Reset for next test run
- vars:
    question: |
      Delete all loaded layers and reset the view to 2D mode to prepare for the next test run.
      Respond with <1> if all layers were successfully deleted and the view was reset, or <0> if it failed. Only respond with <1> or <0>.
  assert:
    - type: contains-all
      value: "<1>"
    - type: not-contains
      value: "<0>"
  options:
    cache: false
    runSerially: true
